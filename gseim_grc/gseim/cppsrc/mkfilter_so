#
# meant for running from user's /gseim/cppsrc directory
#
MAKEFILE = mkfilter_so
GPP = g++
OPT = -c -fPIC
#
OBJ  = \
  utils_pic.o  \
  matrix_2_pic.o  \
  ijmat_pic.o  \
  pic_dummy.o

ifeq ($(shell uname),Darwin)
	LDFLAGS=-install_name,libfilter.so
else
	LDFLAGS=-soname,libfilter.so
endif

PROGRAM = libfilter.so
all: $(PROGRAM)
#
libfilter.so: $(OBJ) 
	g++ -shared -Wl,$(LDFLAGS) -o libfilter.so -std=c++11 $(OBJ)
utils_pic.o: utils.h \
  utils.cpp
	$(GPP) -c -fPIC utils.cpp -o utils_pic.o
matrix_2_pic.o: matrix_2.h \
  matrix_2.cpp
	$(GPP) -c -fPIC matrix_2.cpp -o matrix_2_pic.o
ijmat_pic.o: ijmat.h \
  ijmat.cpp
	$(GPP) -c -fPIC ijmat.cpp -o ijmat_pic.o
pic_dummy.o: pic_dummy.cpp
	$(GPP) -c -fPIC pic_dummy.cpp -o pic_dummy.o
